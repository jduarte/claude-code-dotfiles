version: '3.8'

services:
  salsify-glossary:
    build:
      context: .
      dockerfile: Dockerfile
    container_name: salsify-glossary
    volumes:
      # Mount glossary data from host
      - ./data:/app/data:ro
      # Persist database
      - glossary-db:/app/db
    environment:
      - NODE_ENV=production
    # For development, you can use this instead:
    # command: npm run dev

  # Development service with live reload
  dev:
    build:
      context: .
      dockerfile: Dockerfile
      target: builder
    container_name: salsify-glossary-dev
    volumes:
      - ./src:/app/src
      - ./data:/app/data
      - ./db:/app/db
    command: npm run dev
    profiles:
      - dev

volumes:
  glossary-db:
